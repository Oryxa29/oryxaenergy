<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Verify - Oryxa Energy Solutions</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">
</head>

<body class="verify-page">

  <header id="header" class="header sticky-top">
    <div class="topbar d-flex align-items-center dark-background">
      <div class="container d-flex justify-content-center justify-content-md-between">
        <div class="contact-info d-flex align-items-center">
          <i class="bi bi-envelope d-flex align-items-center"><a href="mailto:ask@oryxaenergy.com">ask@oryxaenergy.com</a></i>
          <i class="bi bi-phone d-flex align-items-center ms-4"><span>+971(04)-369-5158</span></i>
        </div>
        <div class="social-links d-none d-md-flex align-items-center">
          <a href="https://x.com/oryxaenergy" class="twitter"><i class="bi bi-twitter-x"></i></a>
          <a href="https://www.facebook.com/people/Oryxa-Energy-Solutions/61579291776234/" class="facebook"><i class="bi bi-facebook"></i></a>
          <a href="https://www.instagram.com/oryxa.energy.solutions?igsh=bDJycmp4MWM5czF1&utm_source=qr" class="instagram"><i class="bi bi-instagram"></i></a>
          <a href="https://www.linkedin.com/company/oryxa-energy-solutions/?viewAsMember=true" class="linkedin"><i class="bi bi-linkedin"></i></a>
        </div>
      </div>
    </div>

    <div class="branding">
      <div class="container position-relative d-flex align-items-center justify-content-between">
        <a href="index.html" class="logo d-flex align-items-center">
          <h1 class="sitename"><img src="assets/img/ORYXA LOGO CMYK.png" alt="Oryxa Energy Solutions Logo" style="height:60px;"></h1>
        </a>

        <nav id="navmenu" class="navmenu">
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="services.html">Services</a></li>
            <li><a href="verify.html" class="active">Verify</a></li>
            <li class="dropdown"><a href="#"><span>Products</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
              <ul>
                <li class="dropdown"><a href="#"><span>Inverters</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
                  <ul>
                    <li><a href="Residential.html">Residential</a></li>
                    <li><a href="Commercial and Industrial.html">Commercial & Industrial</a></li>
                  </ul>
                </li>
                <li><a href="Solar-Panels.html">Solar Panels</a></li>
                <li><a href="Energy-Storage.html">Energy Storage</a></li>
                <li><a href="Water-Heaters.html">Water Heaters</a></li>
                <li><a href="Air-Conditions.html">Air Conditions</a></li>
              </ul>
            </li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
          <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
        </nav>
      </div>
    </div>
  </header>

  <main class="main">
    <!-- Page Title -->
    <div class="page-title" data-aos="fade">
      <div class="container">
        <nav class="breadcrumbs">
          <ol>
            <li><a href="index.html">Home</a></li>
            <li class="current">Verify</li>
          </ol>
        </nav>
        <h1>Verify</h1>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <!-- Verification Section -->
          <section class="tabs-content" id="product-verification" style="padding: 80px 0; text-align: center;">
            <!-- Part 1: Product Verification -->
            <div class="section-heading">
              <h4><strong>Product Verification</strong></h4>
              <p>Enter your product’s <strong>Serial Number</strong> to confirm its authenticity.</p>
            </div>

            <form id="product-check-form" style="max-width: 420px; margin: 0 auto;">
              <input
                type="text"
                id="serialNumber"
                class="form-control"
                placeholder="Enter Serial Number"
                required
                autocomplete="off"
                style="height: 50px; margin-bottom: 20px; text-align: center; font-size: 16px; border-radius: 25px;"
                onmouseover="this.style.borderColor='#3e4095';"
                onmouseout="this.style.borderColor='#ced4da';"
              >
              <div class="newsletter-form">
                <button type="submit" class="btn" id="verifyProductBtn" aria-label="Verify Product" style="background-color: #2b2d7c; border-color: #2b2d7c; color: #fff; border-radius: 50px; padding-left: 20px; padding-right: 20px;" onmouseover="this.style.backgroundColor='#3e4095'; this.style.borderColor='#3e4095';" onmouseout="this.style.backgroundColor='#2b2d7c'; this.style.borderColor='#2b2d7c';">Verify Product</button>
              </div>
            </form>

            <div id="product-result" style="margin-top: 20px; font-size: 16px;"></div>

            <hr style="margin: 60px 0; border-top: 1px solid #ddd;">

            <!-- Part 2: Warranty Verification -->
            <div class="section-heading">
              <h4><strong>Warranty Certificate Verification</strong></h4>
              <p>Enter your <strong>Warranty Certificate Number</strong> to check its validity.</p>
            </div>

            <form id="warranty-check-form" style="max-width: 420px; margin: 0 auto;">
              <input
                type="text"
                id="warrantyNumber"
                class="form-control"
                placeholder="Enter Warranty Certificate Number"
                required
                autocomplete="off"
                style="height: 50px; margin-bottom: 20px; text-align: center; font-size: 16px; border-radius: 25px;"
                onmouseover="this.style.borderColor='#3e4095';"
                onmouseout="this.style.borderColor='#ced4da';"
              >
              <div class="newsletter-form">
                <button type="submit" class="btn" id="verifyWarrantyBtn" aria-label="Verify Warranty" style="background-color: #2b2d7c; border-color: #2b2d7c; color: #fff; border-radius: 50px; padding-left: 20px; padding-right: 20px;" onmouseover="this.style.backgroundColor='#3e4095'; this.style.borderColor='#3e4095';" onmouseout="this.style.backgroundColor='#2b2d7c'; this.style.borderColor='#2b2d7c';">Verify Warranty</button>
              </div>
            </form>

            <div id="warranty-result" style="margin-top: 20px; font-size: 16px;"></div>
          </section>

          <!-- UPDATED JS (shows Valid / Expired / Not Registered Warranty) -->
          <script>
          (function () {
            // ===== CONFIG =====
            // EDIT HERE: paste your deployed Apps Script Web App URL (ends with /exec)
            const BASE_URL = 'https://script.google.com/macros/s/AKfycbzT6pHcru93o5MgtDNdlXyXD9SuiKT0Vs-totFx8GdHmyWXaqfZSbtDLI9TiHJjLfOW/exec';
            // Optional shared secret (set same in Apps Script if you use it)
            const API_KEY  = '';

  /* ==== helpers ==== */
  const escapeHtml = (s) => String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  const setLoading = (btn, on) => {
    if (!btn) return;
    if (on) { btn.dataset.prevText = btn.textContent; btn.textContent = 'Checking…'; btn.disabled = true; }
    else { btn.textContent = btn.dataset.prevText || 'Verify'; btn.disabled = false; }
  };
  const render = (el, ok, title, details='') => {
    if (!el) return;
    el.innerHTML = ok
      ? `<div style="color:#27ae60;">✅ ${escapeHtml(title)}${details ? '<br>'+details : ''}</div>`
      : `<div style="color:#c0392b;">❌ ${escapeHtml(title)}${details ? '<br>'+details : ''}</div>`;
  };
  async function callAPI(params) {
    const p = new URLSearchParams(params);
    if (API_KEY) p.set('key', API_KEY);
    const url = `${BASE_URL}?${p.toString()}`;
    const res = await fetch(url, { method: 'GET', mode: 'cors', cache: 'no-store' });
    if (!res.ok) throw new Error('network');
    return res.json();
  }

  /* small helper: build a single-line warranty status */
  function warrantyLineFrom(data) {
    if (!data || !data.warrantyExpiry) return '';
    if (data.valid) return 'Warranty: Active until ' + escapeHtml(data.warrantyExpiry);
    if (data.reason === 'expired') return 'Warranty: Expired on ' + escapeHtml(data.warrantyExpiry);
    return '';
  }

  /* Decide messaging from API response (supports product + warranty) */
  function interpret(data, kind) {
    if (data && data.ok === false) {
      return { ok:false, title:'Verification failed (' + (data.error || 'unknown') + ').', extra:'' };
    }
    const found = (typeof data?.found === 'boolean') ? data.found : !!data?.valid;

    if (!found) {
      return {
        ok:false,
        title: (kind === 'product') ? 'Not Registered Product / Not Original' : 'Not Registered Warranty',
        extra:''
      };
    }

    if (kind === 'product') {
      // Product authenticity = true if serial found, regardless of warranty status
      return { ok:true, title:'Oryxa Original Product', extra:''};
    }

    // Warranty flow (show only expiry info)
    if (data.valid) {
      return { ok:true, title:'Valid Oryxa Warranty Certificate',
               extra: data.warrantyExpiry ? 'Valid until: ' + escapeHtml(data.warrantyExpiry) : '' };
    } else {
      return { ok:false, title:'Not Valid — expired',
               extra: data.warrantyExpiry ? 'Expired on: ' + escapeHtml(data.warrantyExpiry) : '' };
    }
  }

  /* ===== hook up forms ===== */
  // Product
  const productForm   = document.getElementById('product-check-form');
  const productInput  = document.getElementById('serialNumber');
  const productBtn    = document.getElementById('verifyProductBtn');
  const productResult = document.getElementById('product-result');

  productForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const serial = (productInput?.value || '').trim().toUpperCase();
    if (!serial) { render(productResult, false, 'Please enter a serial number.'); return; }
    setLoading(productBtn, true);
    try {
      const data = await callAPI({ serial });
      const view = interpret(data, 'product');
      render(productResult, view.ok, view.title, view.extra);
    } catch (err) {
      render(productResult, false, 'Verification failed. Try again later.');
    } finally {
      setLoading(productBtn, false);
    }
  });

  // Warranty
  const warrantyForm   = document.getElementById('warranty-check-form');
  const warrantyInput  = document.getElementById('warrantyNumber');
  const warrantyBtn    = document.getElementById('verifyWarrantyBtn');
  const warrantyResult = document.getElementById('warranty-result');

  warrantyForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const warranty = (warrantyInput?.value || '').trim().toUpperCase();
    if (!warranty) { render(warrantyResult, false, 'Please enter a warranty certificate number.'); return; }
    setLoading(warrantyBtn, true);
    try {
      const data = await callAPI({ warranty });
      const view = interpret(data, 'warranty');
      render(warrantyResult, view.ok, view.title, view.extra);
    } catch (err) {
      render(warrantyResult, false, 'Verification failed. Try again later.');
    } finally {
      setLoading(warrantyBtn, false);
    }
  });

  // Optional: URL auto-fill (?serial=... & ?warranty=...)
  const qs = new URLSearchParams(location.search);
  if (qs.get('serial') && productInput) {
    productInput.value = qs.get('serial').toUpperCase();
    productForm.requestSubmit();
  }
  if (qs.get('warranty') && warrantyInput) {
    warrantyInput.value = qs.get('warranty').toUpperCase();
    warrantyForm.requestSubmit();
  }
})();
</script>
        </div>
      </div>
    </div>
  </main>

  <footer id="footer" class="footer position-relative dark-background">
    <div class="container footer-top">
      <div class="row gy-4">
        <div class="col-lg-4 col-md-6 footer-about">
          <a class="d-flex align-items-center">
            <span class="sitename">Oryxa Energy Solutions</span>
          </a>
          <div class="footer-contact pt-3">
            <p>Ofiice 603 - Warsan Towers - Barsha Heights</p>
            <p>Dubai - UAE</p>
            <p class="mt-3"><strong>Phone:</strong> <span>+971(04)-369-5158</span></p>
            <p><strong>Email:</strong> <span>ask@oryxaenergy.com</span></p>
          </div>
        </div>

        <div class="col-lg-2 col-md-3 footer-links">
          <h4>Site Map</h4>
          <ul>
            <li><i class="bi bi-chevron-right"></i> <a href="about.html">About Us</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="services.html">Our Services</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="verify.html">Verify</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="contact.html">Contact Us</a></li>
          </ul>
        </div>

        <div class="col-lg-2 col-md-3 footer-links">
          <h4>Our Products</h4>
          <ul>
            <li><i class="bi bi-chevron-right"></i> <a href="Residential.html">Residential</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="Commercial and Industrial.html">Commercial & Industrial</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="Solar-Panels.html">Solar Panels</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="Energy-Storage.html">Battery Storage</a></li>
          </ul>
        </div>

        <div class="col-lg-4 col-md-12">
          <h4>Follow Us</h4>
          <p>Stay connected with Oryxa Energy Solutions for updates, insights, and innovations shaping a sustainable future.</p>
          <div class="social-links d-flex">
            <a href="https://x.com/oryxaenergy"><i class="bi bi-twitter-x"></i></a>
            <a href="https://www.facebook.com/people/Oryxa-Energy-Solutions/61579291776234/"><i class="bi bi-facebook"></i></a>
            <a href="https://www.instagram.com/oryxa.energy.solutions?igsh=bDJycmp4MWM5czF1&utm_source=qr"><i class="bi bi-instagram"></i></a>
            <a href="https://www.linkedin.com/company/oryxa-energy-solutions/?viewAsMember=true"><i class="bi bi-linkedin"></i></a>
          </div>
        </div>
      </div>
    </div>

    <div class="container copyright text-center mt-4">
      <p>© <span>Copyright</span> <strong class="px-1 sitename">Oryxa Energy Solutions</strong> <span>All Rights Reserved</span></p>
    </div>
  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>
</body>
</html>